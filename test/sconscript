import os

Import('env')

# copy parent environment so our alterations don't affect it
env = env.Clone()
env.Append(CPPPATH  =  '../include')
# add any files in the current directory
test_srcs = Glob(os.path.join(os.getcwd(), './*.cc'))
env['CPPDEFINES'].append(('LOGGING_IMPLEMENTATION', 1))
# build a program that uses the source files as a shared library
for test_src in test_srcs:
    test_name = 'test_{}'.format(os.path.basename(str(test_src)).split('.')[0])
    print(test_name)
    env.Program(test_name, test_src, LIBS=['rdc', 'pthread', 'dl'],
                LIBPATH='../lib/', RPATH=os.path.join(os.getcwd(),'../lib/'))
